# Core runtime
NODE_ENV=production
API_PORT=3000
API_INTERNAL_PORT=3000
PORT=3000
REQUEST_BODY_LIMIT_MB=5
FRONTEND_URL=http://<EC2_PUBLIC_IP>:3001
# false for HTTP EC2 IP deployment, true when serving HTTPS
COOKIE_SECURE=false
JWT_SECRET=<CHANGE_ME_STRONG_SECRET>

# Database
# Local DB:
DATABASE_HOST=postgres
# External RDS:
# DATABASE_HOST=<RDS_HOST>
DATABASE_PORT=5432
DATABASE_USER=postgres
DATABASE_PASSWORD=<CHANGE_ME_DB_PASSWORD>
DATABASE_NAME=order_project
DATABASE_SSL=false
DATABASE_SSL_REJECT_UNAUTHORIZED=false
DATABASE_POOL_MAX=10
DATABASE_POOL_MIN=5
DATABASE_CONNECTION_TIMEOUT_MS=5000
DATABASE_IDLE_TIMEOUT_MS=30000
STATEMENT_TIMEOUT_MS=30000
TYPEORM_SYNC=false
ALLOW_TYPEORM_SYNC_WITH_NON_OWNER=0
ALLOW_BYPASSRLS=0

# Migrations and seed bootstrap
RUN_MIGRATIONS_ON_START=true
REQUIRE_NO_PENDING_MIGRATIONS=true
RUN_RBAC_BASELINE_ON_START=true
BOOTSTRAP_DEFAULT_BRANCH_NAME=Main Branch
BOOTSTRAP_DEFAULT_BRANCH_CODE=MB
BOOTSTRAP_ADMIN_USERNAME=admin
BOOTSTRAP_ADMIN_PASSWORD=<CHANGE_ME_ADMIN_PASSWORD>
BOOTSTRAP_ADMIN_NAME=System Administrator
BOOTSTRAP_ADMIN_BRANCH_ID=

# Redis (session/cache)
# Local Redis:
REDIS_URL=redis://redis:6379
# External Redis:
# REDIS_URL=redis://default:<password>@<host>:<port>
REDIS_TLS=false
REDIS_TLS_REJECT_UNAUTHORIZED=false
REDIS_TLS_AUTO_FALLBACK=false
REDIS_CONNECT_TIMEOUT_MS=5000
REDIS_DISABLED=false
REDIS_PREFIX=pos-prod

# Rate limit Redis
RATE_LIMIT_REDIS_URL=redis://redis:6379
RATE_LIMIT_REDIS_TLS=false
RATE_LIMIT_REDIS_TLS_REJECT_UNAUTHORIZED=false
RATE_LIMIT_REDIS_TLS_AUTO_FALLBACK=false
RATE_LIMIT_REDIS_DISABLED=false
RATE_LIMIT_REDIS_CONNECT_TIMEOUT_MS=5000
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX=20000
RATE_LIMIT_AUTH_WINDOW_MS=900000
RATE_LIMIT_AUTH_MAX=20
RATE_LIMIT_ORDER_WINDOW_MS=60000
RATE_LIMIT_ORDER_MAX=30
RATE_LIMIT_PAYMENT_WINDOW_MS=300000
RATE_LIMIT_PAYMENT_MAX=50
RATE_LIMIT_PASSWORD_RESET_WINDOW_MS=3600000
RATE_LIMIT_PASSWORD_RESET_MAX=5

# Session and socket
SESSION_TIMEOUT_MS=28800000
SOCKET_REDIS_ADAPTER_ENABLED=false

# Metrics and health
METRICS_ENABLED=true
METRICS_API_KEY=<CHANGE_ME_METRICS_KEY>
HEALTH_RETENTION_STALE_HOURS=36

# Retention cleanup policy (used by cron)
RETENTION_LOG_FILE=/app/logs/retention-jobs.log
RETENTION_WARN_DELETED_TOTAL=5000
ORDER_RETENTION_ENABLED=true
ORDER_RETENTION_DRY_RUN=false
ORDER_RETENTION_DAYS=30
ORDER_QUEUE_RETENTION_ENABLED=true
ORDER_QUEUE_RETENTION_DRY_RUN=false
ORDER_QUEUE_RETENTION_DAYS=14
STOCK_ORDER_RETENTION_ENABLED=true
STOCK_ORDER_RETENTION_DRY_RUN=false
STOCK_ORDER_RETENTION_DAYS=7
AUDIT_LOG_RETENTION_ENABLED=true
AUDIT_LOG_RETENTION_DRY_RUN=false
AUDIT_LOG_RETENTION_DAYS=90

# Optional performance logs
ENABLE_PERF_LOG=false
ENABLE_SLOW_REQUEST_LOG=false
SLOW_REQUEST_THRESHOLD_MS=800
